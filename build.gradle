plugins {
    id 'org.ajoberstar.grgit' version '1.3.2'
    id "edu.sc.seis.macAppBundle" version "2.1.5"
}

apply plugin: 'application'
mainClassName = 'com.mucommander.Launcher'

allprojects {
    apply plugin: 'java'
    group = 'org.mucommander'
    version = '0.9.1'
}

ext {
    // Open the Git repository in the current directory.
    git = org.ajoberstar.grgit.Grgit.open(file('.'))

    // Get commit id of HEAD.
    revision = git.head().id
}

repositories.jcenter()

dependencies {
    compile project('mucommander-commons-file')
    compile project('mucommander-commons-conf')
    compile project('mucommander-commons-collections')

    compile 'org.jmdns:jmdns:3.5.0'
    compile 'org.slf4j:slf4j-api:1.7.13'
    compile 'ch.qos.logback:logback-core:1.1.3'
    compile 'ch.qos.logback:logback-classic:1.1.3'
    compile 'com.jidesoft:jide-oss:3.6.12'
    compile files('libs/java-extension.jar')

    testCompile 'org.testng:testng:6.9.10'
    testCompile 'junit:junit:4.12'
}

jar {
    manifest {
        attributes("Main-Class": mainClassName,
                   "Specification-Title": "muCommander",
                   "Specification-Vendor": "Arik Hadas",
                   "Specification-Version": version,
                   "Implementation-Title": "muCommander",
                   "Implementation-Vendor": "Arik Hadas",
                   "Implementation-Version": revision.substring(0, 7),
                   "Build-Date": new Date().format('yyyyMMdd'),
                   "Build-URL": "http://www.mucommander.com/version/nightly.xml")
    }
}

macAppBundle {
    appName = "muCommander"
    mainClassName = "com.mucommander.Launcher"
    appStyle = "Oracle"
    bundleIdentifier = "com.mucommander.muCommander"
    jvmVersion = "1.6+"
    icon = "package/osx/icon.icns"
    bundleAllowMixedLocalizations = "true"

    javaProperties.put("java.system.class.loader", "com.mucommander.commons.file.AbstractFileClassLoader")
    javaProperties.put("com.apple.smallTabs", "true")
    javaProperties.put("com.apple.hwaccel", "true")
    javaProperties.put("apple.laf.useScreenMenuBar", "true")
    javaProperties.put("file.encoding", "UTF-8")
}

